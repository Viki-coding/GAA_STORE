{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center">{{ hurley.product.name }}</h1>
    <div class="row">
        <div class="col-md-6">
            <img src="{{ hurley.product.image.url }}" alt="{{ hurley.product.name }}" class="img-fluid">
            <p id="manufacturer-description" class="mt-3"></p> 
        </div>
        <div class="col-md-6">
            <p><strong>Price:</strong> â‚¬{{ hurley.product.price }}</p>
            <p><strong>Description:</strong> {{ hurley.product.description }}</p>
            <form method="POST" action="{% url 'add_to_bag' hurley.product.id %}">
                {% csrf_token %}
                <div class="form-group">
                    <label for="size">Size:</label>
                    <select id="size" name="size" class="form-control">
                        {% for size, size_label in size_choices %}
                            <option value="{{ size }}">{{ size_label }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="manufacturer">Manufacturer:</label>
                    <select id="manufacturer" name="manufacturer" class="form-control">
                        {% for manufacturer in manufacturers %}
                            <option value="{{ manufacturer.id }}">{{ manufacturer.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="weight">Weight:</label>
                    <select id="weight" name="weight" class="form-control">
                        {% for weight, weight_label in weight_choices %}
                            <option value="{{ weight }}">{{ weight_label }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="grip_color">Grip Color:</label>
                    <select id="grip_color" name="grip_color" class="form-control">
                        {% for color, color_label in grip_color_choices %}
                            <option value="{{ color }}">{{ color_label }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="quantity">Quantity:</label>
                    <input type="number" id="quantity" name="quantity" value="1" min="1" class="form-control mb-3">
                </div>
                <button type="submit" class="btn btn-primary">Add to Bag</button>
            </form>
        </div>
    </div>
</div>

<script>
    // Get references to the manufacturer dropdown and description placeholder
    const manufacturerDropdown = document.getElementById('manufacturer');
    const manufacturerDescription = document.getElementById('manufacturer-description');

    // Create a mapping of manufacturer IDs to their descriptions
    const manufacturerDescriptions = {
        {% for manufacturer in manufacturers %}
            "{{ manufacturer.id|escapejs }}": "{{ manufacturer.description|escapejs }}",
        {% endfor %}
    };

    // Add an event listener to update the description when the manufacturer changes
    manufacturerDropdown.addEventListener('change', function () {
        const selectedManufacturerId = this.value;
        const description = manufacturerDescriptions[selectedManufacturerId] || '';
        manufacturerDescription.textContent = description; // Update the description
    });

    // Trigger the event listener on page load to show the default description
    manufacturerDropdown.dispatchEvent(new Event('change'));
</script>
{% endblock %}